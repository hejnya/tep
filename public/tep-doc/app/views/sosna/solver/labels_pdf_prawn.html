<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>labels.pdf.prawn - RDoc Documentation</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "../../../../";
  var index_rel_prefix = "../../../../";
</script>

<script src="../../../../js/jquery.js"></script>
<script src="../../../../js/darkfish.js"></script>

<link href="../../../../css/fonts.css" rel="stylesheet">
<link href="../../../../css/rdoc.css" rel="stylesheet">



<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="../../../../index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="../../../../table_of_contents.html#pages">Pages</a>
    <a href="../../../../table_of_contents.html#classes">Classes</a>
    <a href="../../../../table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="project-metadata">
    <div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
  
    <li><a href="../../../../app/views/sosna/solver/labels_pdf_prawn.html">labels.pdf.prawn</a>
  
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-label="Page app/views/sosna/solver/labels.pdf.prawn">

<p>require &#39;prawn/measurement_extensions&#39; require &#39;pp&#39;</p>

<p>o = {} omm = {}</p>

<p><a href=":h">omm</a> = (@<a href=":h">opt</a>||30).to_i <a
href=":w">omm</a> = (@<a href=":w">opt</a>||50).to_i</p>

<p><a href=":l">omm</a> = (@<a href=":l">opt</a>||10).to_i <a
href=":t">omm</a> = (@<a href=":t">opt</a>||10).to_i</p>

<p><a href=":dx">omm</a> = (@<a href=":dx">opt</a>||3).to_i <a
href=":dy">omm</a> = (@<a href=":dy">opt</a>||3).to_i</p>

<p><a href=":al">omm</a> = (@<a href=":al">opt</a>||50).to_i <a
href=":at">omm</a> = (@<a href=":at">opt</a>||50).to_i</p>

<p><a href=":pl">omm</a> = (@<a href=":pl">opt</a>||50).to_i <a
href=":pt">omm</a> = (@<a href=":pt">opt</a>||50).to_i</p>

<p><a href=":s">omm</a> = (@<a href=":s">opt</a>||10).to_i</p>

<p><a href=":as">omm</a> = (@<a href=":ps">opt</a>||10).to_i <a
href=":ps">omm</a> = (@<a href=":as">opt</a>||10).to_i</p>

<p>omm.each do |k,v|</p>

<pre class="ruby"><span class="ruby-identifier">o</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-identifier">v</span>.<span class="ruby-identifier">mm</span>
</pre>

<p>end <a href=":s">o</a> = <a href=":s">omm</a> <a href=":ps">o</a> = <a
href=":ps">omm</a> <a href=":as">o</a> = <a href=":as">omm</a></p>

<p>pdf.font_size = <a href=":s">o</a></p>

<p>pdf.text pp(@opt).to_s if @dbg</p>

<p>ph =  pdf.margin_box.height pw =  pdf.margin_box.width</p>

<p>def arrow(pdf, txt, x0, y0, x1, y1)</p>

<pre>u = 0.3.mm
pdf.line [x0, y0], [x1, y1]

pdf.line [x0 -u , y0 - u ], [x0 + u , y0 + u ]
pdf.line [x0 -u , y0 + u ], [x0 + u , y0 - u ]

pdf.line [x1 -u , y1 - u ], [x1 + u , y1 + u ] 
pdf.line [x1 -u , y1 + u ], [x1 + u , y1 - u ] 

pdf.stroke
pdf.draw_text txt, :at =&gt; [(x0 +x1)/2 +0.5.mm, (y0+y1)/2 +0.5.mm]</pre>

<p>end</p>

<p>def cross(pdf, o, omm)</p>

<pre class="ruby"> <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">font_size</span> = <span class="ruby-value">10</span>
 <span class="ruby-identifier">ph</span> =  <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">margin_box</span>.<span class="ruby-identifier">height</span>
 <span class="ruby-identifier">pw</span> =  <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">margin_box</span>.<span class="ruby-identifier">width</span>

 <span class="ruby-identifier">pwh</span> = <span class="ruby-identifier">pw</span><span class="ruby-operator">/</span><span class="ruby-value">2</span>

 <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">line_width</span> <span class="ruby-value">0.1</span>.<span class="ruby-identifier">mm</span>
 <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">stroke_color</span> <span class="ruby-string">&#39;a0a0a0&#39;</span>
 <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">fill_color</span> <span class="ruby-string">&#39;a0a0a0&#39;</span>

 [<span class="ruby-value">20</span>.<span class="ruby-identifier">mm</span>, <span class="ruby-identifier">ph</span><span class="ruby-operator">/</span><span class="ruby-value">2</span>, <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-value">20</span>.<span class="ruby-identifier">mm</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">yy</span><span class="ruby-operator">|</span> 
   <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">line</span> [<span class="ruby-value">0</span>, <span class="ruby-identifier">yy</span>], [<span class="ruby-identifier">pw</span>,<span class="ruby-identifier">yy</span>]
   (<span class="ruby-value">0</span> <span class="ruby-operator">..</span> <span class="ruby-identifier">pw</span>).<span class="ruby-identifier">step</span>(<span class="ruby-value">1</span>.<span class="ruby-identifier">mm</span>).<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">x</span>,<span class="ruby-identifier">i</span><span class="ruby-operator">|</span>

      <span class="ruby-identifier">d</span> = <span class="ruby-identifier">i</span><span class="ruby-operator">%</span><span class="ruby-value">10</span><span class="ruby-operator">==</span><span class="ruby-value">0</span>  <span class="ruby-operator">?</span> <span class="ruby-value">6</span>.<span class="ruby-identifier">mm</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">i</span><span class="ruby-operator">%</span><span class="ruby-value">5</span><span class="ruby-operator">==</span><span class="ruby-value">0</span>  <span class="ruby-operator">?</span> <span class="ruby-value">3</span>.<span class="ruby-identifier">mm</span> <span class="ruby-operator">:</span> <span class="ruby-value">2</span>.<span class="ruby-identifier">mm</span>
      <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">line</span>([<span class="ruby-identifier">x</span>, <span class="ruby-identifier">yy</span>], [<span class="ruby-identifier">x</span>, <span class="ruby-identifier">yy</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">d</span>])
   <span class="ruby-keyword">end</span>
 <span class="ruby-keyword">end</span>

 [<span class="ruby-value">20</span>.<span class="ruby-identifier">mm</span>, <span class="ruby-identifier">pw</span><span class="ruby-operator">/</span><span class="ruby-value">2</span>, <span class="ruby-identifier">pw</span> <span class="ruby-operator">-</span> <span class="ruby-value">20</span>.<span class="ruby-identifier">mm</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">xx</span><span class="ruby-operator">|</span> 
   <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">line</span> [<span class="ruby-identifier">xx</span>, <span class="ruby-value">0</span>], [<span class="ruby-identifier">xx</span>,<span class="ruby-identifier">ph</span>]
   (<span class="ruby-value">0</span> <span class="ruby-operator">..</span> <span class="ruby-identifier">ph</span>).<span class="ruby-identifier">step</span>(<span class="ruby-value">1</span>.<span class="ruby-identifier">mm</span>).<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">y</span>,<span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">d</span> = <span class="ruby-identifier">i</span><span class="ruby-operator">%</span><span class="ruby-value">10</span><span class="ruby-operator">==</span><span class="ruby-value">0</span>  <span class="ruby-operator">?</span> <span class="ruby-value">6</span>.<span class="ruby-identifier">mm</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">i</span><span class="ruby-operator">%</span><span class="ruby-value">5</span><span class="ruby-operator">==</span><span class="ruby-value">0</span>  <span class="ruby-operator">?</span> <span class="ruby-value">3</span>.<span class="ruby-identifier">mm</span> <span class="ruby-operator">:</span> <span class="ruby-value">2</span>.<span class="ruby-identifier">mm</span>
      <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">line</span>([<span class="ruby-identifier">xx</span>, <span class="ruby-identifier">ph</span><span class="ruby-operator">-</span><span class="ruby-identifier">y</span>], [<span class="ruby-identifier">xx</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">d</span>, <span class="ruby-identifier">ph</span><span class="ruby-operator">-</span><span class="ruby-identifier">y</span>])
   <span class="ruby-keyword">end</span>
 <span class="ruby-keyword">end</span>

 <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">stroke</span>

 <span class="ruby-keyword">if</span> <span class="ruby-ivar">@envelope</span>
   <span class="ruby-identifier">arrow</span> <span class="ruby-identifier">pdf</span>, <span class="ruby-node">&quot;pt:#{omm[:pt]}&quot;</span>, <span class="ruby-value">10</span>.<span class="ruby-identifier">mm</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:pl</span>], <span class="ruby-identifier">ph</span>, <span class="ruby-value">10</span>.<span class="ruby-identifier">mm</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:pl</span>], <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:pt</span>]
   <span class="ruby-identifier">arrow</span> <span class="ruby-identifier">pdf</span>, <span class="ruby-node">&quot;at:#{omm[:at]}&quot;</span>, <span class="ruby-value">10</span>.<span class="ruby-identifier">mm</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:al</span>], <span class="ruby-identifier">ph</span>, <span class="ruby-value">10</span>.<span class="ruby-identifier">mm</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:al</span>], <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:at</span>]

   <span class="ruby-identifier">arrow</span> <span class="ruby-identifier">pdf</span>, <span class="ruby-node">&quot;pl:#{omm[:pt]}&quot;</span>, <span class="ruby-value">0</span>.<span class="ruby-identifier">mm</span>, <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:pt</span>] <span class="ruby-operator">-</span> <span class="ruby-value">15</span>.<span class="ruby-identifier">mm</span>,  <span class="ruby-identifier">o</span>[<span class="ruby-value">:pl</span>], <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:pt</span>] <span class="ruby-operator">-</span> <span class="ruby-value">15</span>.<span class="ruby-identifier">mm</span>
   <span class="ruby-identifier">arrow</span> <span class="ruby-identifier">pdf</span>, <span class="ruby-node">&quot;al:#{omm[:at]}&quot;</span>, <span class="ruby-value">0</span>.<span class="ruby-identifier">mm</span>, <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:at</span>] <span class="ruby-operator">-</span> <span class="ruby-value">15</span>.<span class="ruby-identifier">mm</span>,  <span class="ruby-identifier">o</span>[<span class="ruby-value">:al</span>], <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:at</span>] <span class="ruby-operator">-</span> <span class="ruby-value">15</span>.<span class="ruby-identifier">mm</span>

   <span class="ruby-identifier">arrow</span> <span class="ruby-identifier">pdf</span>, <span class="ruby-node">&quot;h:#{omm[:h]}&quot;</span>, <span class="ruby-identifier">o</span>[<span class="ruby-value">:w</span>] <span class="ruby-operator">-</span> <span class="ruby-value">10</span>.<span class="ruby-identifier">mm</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:al</span>], <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:at</span>],  <span class="ruby-identifier">o</span>[<span class="ruby-value">:w</span>] <span class="ruby-operator">-</span> <span class="ruby-value">10</span>.<span class="ruby-identifier">mm</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:al</span>], <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:at</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:h</span>]
   <span class="ruby-identifier">arrow</span> <span class="ruby-identifier">pdf</span>, <span class="ruby-node">&quot;w:#{omm[:w]}&quot;</span>, <span class="ruby-identifier">o</span>[<span class="ruby-value">:al</span>], <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:at</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:h</span>] <span class="ruby-operator">+</span> <span class="ruby-value">10</span>.<span class="ruby-identifier">mm</span>, <span class="ruby-identifier">o</span>[<span class="ruby-value">:w</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:al</span>],  <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:at</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:h</span>] <span class="ruby-operator">+</span> <span class="ruby-value">10</span>.<span class="ruby-identifier">mm</span>

   <span class="ruby-identifier">arrow</span> <span class="ruby-identifier">pdf</span>, <span class="ruby-node">&quot;as:#{omm[:s]}pt&quot;</span>, <span class="ruby-identifier">o</span>[<span class="ruby-value">:w</span>]<span class="ruby-operator">-</span> <span class="ruby-value">10</span>.<span class="ruby-identifier">mm</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:al</span>], <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:at</span>], <span class="ruby-identifier">o</span>[<span class="ruby-value">:w</span>]<span class="ruby-operator">-</span> <span class="ruby-value">10</span>.<span class="ruby-identifier">mm</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:al</span>], <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:at</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:as</span>]
   <span class="ruby-identifier">arrow</span> <span class="ruby-identifier">pdf</span>, <span class="ruby-node">&quot;ps:#{omm[:s]}pt&quot;</span>, <span class="ruby-identifier">o</span>[<span class="ruby-value">:w</span>]<span class="ruby-operator">-</span> <span class="ruby-value">10</span>.<span class="ruby-identifier">mm</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:pl</span>], <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:pt</span>], <span class="ruby-identifier">o</span>[<span class="ruby-value">:w</span>]<span class="ruby-operator">-</span> <span class="ruby-value">10</span>.<span class="ruby-identifier">mm</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:pl</span>], <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:pt</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:ps</span>]

 <span class="ruby-keyword">else</span>
   <span class="ruby-identifier">arrow</span> <span class="ruby-identifier">pdf</span>, <span class="ruby-node">&quot;t:#{omm[:t]}&quot;</span>, <span class="ruby-value">40</span>.<span class="ruby-identifier">mm</span>, <span class="ruby-identifier">ph</span>, <span class="ruby-value">40</span>.<span class="ruby-identifier">mm</span>, <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:t</span>]
   <span class="ruby-identifier">arrow</span> <span class="ruby-identifier">pdf</span>, <span class="ruby-node">&quot;l:#{omm[:l]}&quot;</span>, <span class="ruby-value">0</span>, <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-value">30</span>.<span class="ruby-identifier">mm</span>, <span class="ruby-identifier">o</span>[<span class="ruby-value">:l</span>],  <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-value">30</span>.<span class="ruby-identifier">mm</span>

   <span class="ruby-identifier">arrow</span> <span class="ruby-identifier">pdf</span>, <span class="ruby-node">&quot;h:#{omm[:h]}&quot;</span>, <span class="ruby-value">45</span>.<span class="ruby-identifier">mm</span>, <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:t</span>], <span class="ruby-value">45</span>.<span class="ruby-identifier">mm</span>, <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:t</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:h</span>]
   <span class="ruby-identifier">arrow</span> <span class="ruby-identifier">pdf</span>, <span class="ruby-node">&quot;w:#{omm[:w]}&quot;</span>, <span class="ruby-identifier">o</span>[<span class="ruby-value">:l</span>], <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-value">35</span>.<span class="ruby-identifier">mm</span>, <span class="ruby-identifier">o</span>[<span class="ruby-value">:w</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:l</span>],  <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-value">35</span>.<span class="ruby-identifier">mm</span>

   <span class="ruby-identifier">arrow</span> <span class="ruby-identifier">pdf</span>, <span class="ruby-node">&quot;s:#{omm[:s]}pt&quot;</span>, <span class="ruby-value">55</span>.<span class="ruby-identifier">mm</span>, <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:t</span>], <span class="ruby-value">55</span>.<span class="ruby-identifier">mm</span>, <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:t</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:s</span>]

   <span class="ruby-identifier">arrow</span> <span class="ruby-identifier">pdf</span>, <span class="ruby-node">&quot;dy:#{omm[:dy]}&quot;</span>, <span class="ruby-value">50</span>.<span class="ruby-identifier">mm</span>, <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:t</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:h</span>], <span class="ruby-value">50</span>.<span class="ruby-identifier">mm</span>, <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:t</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:h</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:dy</span>]
   <span class="ruby-identifier">arrow</span> <span class="ruby-identifier">pdf</span>, <span class="ruby-node">&quot;dx:#{omm[:dx]}&quot;</span>, <span class="ruby-identifier">o</span>[<span class="ruby-value">:l</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:w</span>], <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-value">30</span>.<span class="ruby-identifier">mm</span>, <span class="ruby-identifier">o</span>[<span class="ruby-value">:l</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:w</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:dx</span>] ,  <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-value">30</span>.<span class="ruby-identifier">mm</span>

<span class="ruby-keyword">end</span>
<span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">stroke_color</span> <span class="ruby-string">&#39;000000&#39;</span>
<span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">fill_color</span> <span class="ruby-string">&#39;000000&#39;</span>
</pre>

<p>end</p>

<p>pdf.font_families.update( &#39;andulka&#39; =&gt; { :normal =&gt;
&#39;public/stylesheets/andulka/andulkabook-webfont.ttf&#39;,</p>

<pre>  :bold   =&gt; &#39;public/stylesheets/andulka/andulkabook-bold-webfont.ttf&#39;,
})</pre>

<p>pdf.font &#39;andulka&#39;</p>

<p>addrs = [] @solvers.each do |solver|</p>

<pre>school_name = nil
if solver.where_to_send == &#39;home&#39;
  street, city, psc, country = [ &quot;#{solver.street} #{solver.num}&quot;, &quot;#{solver.city}&quot;, &quot;#{solver.psc} &quot;, &quot;#{solver.country}&quot; ]
else
  school = solver.school
  next if school.nil?
  school_name, street, city, psc, country = [ &quot;#{school.name}&quot;,  &quot;#{school.street} #{school.num}&quot;, &quot;#{school.city}&quot;, &quot;#{school.psc} &quot;, &quot;#{school.country}&quot; ]
end
title = &quot;#{solver.sex == &#39;female&#39; ? &quot;Řešitelka&quot; : &quot;Řešitel&quot;} Pikomatu MFF UK&quot;
addrs.push( {full: solver.full_name, title: title, street: street, school_name: school_name, city:city, psc: psc, country: country})</pre>

<p>end @schools.each do |school|</p>

<pre class="ruby"><span class="ruby-identifier">school_name</span>, <span class="ruby-identifier">street</span>, <span class="ruby-identifier">city</span>, <span class="ruby-identifier">psc</span>, <span class="ruby-identifier">country</span> = [ <span class="ruby-node">&quot;#{school.name}&quot;</span>,  <span class="ruby-node">&quot;#{school.street} #{school.num}&quot;</span>, <span class="ruby-node">&quot;#{school.city}&quot;</span>, <span class="ruby-node">&quot;#{school.psc} &quot;</span>, <span class="ruby-node">&quot;#{school.country}&quot;</span> ]
<span class="ruby-identifier">title</span> = <span class="ruby-keyword">nil</span>
<span class="ruby-identifier">addrs</span>.<span class="ruby-identifier">push</span>({<span class="ruby-value">full:</span> <span class="ruby-keyword">nil</span>, <span class="ruby-value">title:</span> <span class="ruby-identifier">title</span>, <span class="ruby-value">street:</span> <span class="ruby-identifier">street</span>, <span class="ruby-value">school_name:</span> <span class="ruby-identifier">school_name</span>, <span class="ruby-value">city:</span><span class="ruby-identifier">city</span>, <span class="ruby-value">psc:</span> <span class="ruby-identifier">psc</span>, <span class="ruby-value">country:</span> <span class="ruby-identifier">country</span>})
</pre>

<p>end</p>

<p>if @envelope</p>

<pre class="ruby"><span class="ruby-comment">#####################################################</span>
<span class="ruby-comment"># nakresli obalky</span>
<span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">text</span> <span class="ruby-node">&quot;count: #{@solvers.size}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@dbg</span>
<span class="ruby-identifier">addrs</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">addr</span>,<span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">cross</span> <span class="ruby-identifier">pdf</span>,<span class="ruby-identifier">o</span>, <span class="ruby-identifier">omm</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@dbg</span>
  <span class="ruby-identifier">country_txt</span> = <span class="ruby-identifier">country_code_to_txt</span>(<span class="ruby-identifier">addr</span>[<span class="ruby-value">:country</span>])

  <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">font_size</span> = <span class="ruby-identifier">o</span>[<span class="ruby-value">:ps</span>]
  <span class="ruby-identifier">psc_y</span> = <span class="ruby-value">0</span> 
  <span class="ruby-identifier">name</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">bounding_box</span>([<span class="ruby-identifier">o</span>[<span class="ruby-value">:al</span>], <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:at</span>]],<span class="ruby-value">:width</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:w</span>], <span class="ruby-value">:height</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:h</span>] ) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">text</span> <span class="ruby-node">&quot;&lt;b&gt;#{addr[:title]}&lt;/b&gt;&quot;</span>, <span class="ruby-value">:inline_format</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">addr</span>[<span class="ruby-value">:title</span>]
    <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">text</span> <span class="ruby-node">&quot;#{addr[:full]}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">addr</span>[<span class="ruby-value">:full</span>]
    <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">text</span>  <span class="ruby-identifier">addr</span>[<span class="ruby-value">:school_name</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">addr</span>[<span class="ruby-value">:school_name</span>]
    <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">text</span>  <span class="ruby-identifier">addr</span>[<span class="ruby-value">:street</span>]
    <span class="ruby-identifier">psc_y</span> = <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">cursor</span>
    <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">text</span> <span class="ruby-identifier">addr</span>[<span class="ruby-value">:city</span>]
    <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">text</span> <span class="ruby-node">&quot;#{country_txt}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span> <span class="ruby-identifier">country_txt</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">stroke_bounds</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@dbg</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">bounding_box</span>([<span class="ruby-identifier">o</span>[<span class="ruby-value">:al</span>] <span class="ruby-operator">-</span> <span class="ruby-value">20</span>.<span class="ruby-identifier">mm</span>, <span class="ruby-identifier">psc_y</span>  <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:h</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:at</span>]],<span class="ruby-value">:width</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">20</span>.<span class="ruby-identifier">mm</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>.<span class="ruby-identifier">mm</span>, <span class="ruby-value">:height</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:ps</span>] ) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">text</span> <span class="ruby-identifier">addr</span>[<span class="ruby-value">:psc</span>] , <span class="ruby-value">:align</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:right</span>
    <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">stroke_bounds</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@dbg</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">font_size</span> = <span class="ruby-identifier">o</span>[<span class="ruby-value">:as</span>]
  <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">bounding_box</span>([<span class="ruby-identifier">o</span>[<span class="ruby-value">:pl</span>], <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:pt</span>]],<span class="ruby-value">:width</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:w</span>], <span class="ruby-value">:height</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:h</span>] ) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">text</span> <span class="ruby-string">&quot;&lt;b&gt;Pikomat MFF UK&lt;/b&gt;&quot;</span>, <span class="ruby-value">:inline_format</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-keyword">true</span>, <span class="ruby-value">:align</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:center</span>
    <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">text</span> <span class="ruby-string">&quot;KPMS MFF UK&quot;</span>, <span class="ruby-value">:align</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:center</span>
    <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">text</span> <span class="ruby-string">&quot;Sokolovská 83, 186 75 Praha 8&quot;</span>, <span class="ruby-value">:align</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:center</span>
    <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">text</span> <span class="ruby-string">&quot;Česká Republika&quot;</span>, <span class="ruby-value">:align</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:center</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span> <span class="ruby-identifier">country_txt</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">stroke_bounds</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@dbg</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">start_new_page</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">index</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">addrs</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span> <span class="ruby-comment"># not for last</span>
<span class="ruby-keyword">end</span>
</pre>

<p>else</p>

<pre class="ruby"><span class="ruby-comment">#####################################################</span>
<span class="ruby-comment"># nakresli stitky</span>
<span class="ruby-identifier">x</span> = <span class="ruby-identifier">o</span>[<span class="ruby-value">:l</span>]
<span class="ruby-identifier">y</span> = <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:t</span>]
<span class="ruby-identifier">cross</span> <span class="ruby-identifier">pdf</span>,<span class="ruby-identifier">o</span>, <span class="ruby-identifier">omm</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@dbg</span>
<span class="ruby-ivar">@solvers</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">solver</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">country_txt</span> = <span class="ruby-identifier">country_code_to_txt</span>(<span class="ruby-identifier">solver</span>.<span class="ruby-identifier">country</span>)
  <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">font_size</span> = <span class="ruby-identifier">o</span>[<span class="ruby-value">:s</span>]
  <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">bounding_box</span>([<span class="ruby-identifier">x</span>, <span class="ruby-identifier">y</span>],<span class="ruby-value">:width</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:w</span>], <span class="ruby-value">:height</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:h</span>] ) <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">text</span> <span class="ruby-node">&quot;#{solver.sex == &#39;female&#39; ? &quot;Řešitelka&quot; : &quot;Řešitel&quot;} Pikomatu MFF UK&quot;</span>
    <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">text</span> <span class="ruby-node">&quot;#{solver.full_name}&quot;</span>
    <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">text</span> <span class="ruby-node">&quot;#{solver.street} #{solver.num}&quot;</span>
    <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">text</span> <span class="ruby-node">&quot;#{solver.psc} #{solver.city}&quot;</span>
    <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">text</span> <span class="ruby-node">&quot;#{country_txt}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span> <span class="ruby-identifier">country_txt</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">stroke_bounds</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@dbg</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">x</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:w</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:dx</span>]
  <span class="ruby-identifier">x</span>,<span class="ruby-identifier">y</span> = <span class="ruby-identifier">o</span>[<span class="ruby-value">:l</span>], <span class="ruby-identifier">y</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:h</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:dy</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">x</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:w</span>] <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">pw</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">y</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:h</span>] <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:dy</span>] <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>
   <span class="ruby-keyword">if</span> <span class="ruby-identifier">index</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">solvers</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>  <span class="ruby-comment"># not for last</span>
      <span class="ruby-identifier">pdf</span>.<span class="ruby-identifier">start_new_page</span>
      <span class="ruby-identifier">x</span> = <span class="ruby-identifier">o</span>[<span class="ruby-value">:l</span>]
      <span class="ruby-identifier">y</span> =  <span class="ruby-identifier">ph</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">o</span>[<span class="ruby-value">:t</span>]
      <span class="ruby-identifier">cross</span> <span class="ruby-identifier">pdf</span>,<span class="ruby-identifier">o</span>, <span class="ruby-identifier">omm</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@dbg</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>end</p>

<p># vim: syn=ruby</p>
</main>



<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.0.1.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

